<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-ip: sptrunmv.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-ip
   &#160;<span id="projectnumber">5.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('sptrunmv_8f_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sptrunmv.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="sptrunmv_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">C&gt; @file</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">C&gt; Spectrally interpolate vectors to Mercator</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">C&gt; @author IREDELL @date 96-02-29</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">C&gt; THIS SUBPROGRAM SPECTRALLY TRUNCATES VECTOR FIELDS</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">C&gt;           ON A GLOBAL CYLINDRICAL GRID, RETURNING THE FIELDS</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">C&gt;           TO A MERCATOR GRID.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">C&gt;           THE WAVE-SPACE CAN BE EITHER TRIANGULAR OR RHOMBOIDAL.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">C&gt;           THE GRID-SPACE CAN BE EITHER AN EQUALLY-SPACED GRID</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">C&gt;           (WITH OR WITHOUT POLE POINTS) OR A GAUSSIAN GRID.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">C&gt;           THE GRID FIELDS MAY HAVE GENERAL INDEXING.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">C&gt;           THE TRANSFORMS ARE ALL MULTIPROCESSED.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">C&gt;           TRANSFORM SEVERAL FIELDS AT A TIME TO IMPROVE VECTORIZATION.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">C&gt;           SUBPROGRAM CAN BE CALLED FROM A MULTIPROCESSING ENVIRONMENT.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">C&gt; PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">C&gt;   96-02-29  IREDELL</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">C&gt; 1998-12-15  IREDELL  OPENMP DIRECTIVES INSERTED</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">C&gt; @param IROMB    - INTEGER SPECTRAL DOMAIN SHAPE</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">C&gt;                (0 FOR TRIANGULAR, 1 FOR RHOMBOIDAL)</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">C&gt; @param MAXWV    - INTEGER SPECTRAL TRUNCATION</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">C&gt; @param IDRTI    - INTEGER INPUT GRID IDENTIFIER</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">C&gt;                (IDRTI=4 FOR GAUSSIAN GRID,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">C&gt;                 IDRTI=0 FOR EQUALLY-SPACED GRID INCLUDING POLES,</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">C&gt;                 IDRTI=256 FOR EQUALLY-SPACED GRID EXCLUDING POLES)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">C&gt; @param IMAXI    - INTEGER EVEN NUMBER OF INPUT LONGITUDES.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">C&gt; @param JMAXI    - INTEGER NUMBER OF INPUT LATITUDES.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">C&gt; @param KMAX     - INTEGER NUMBER OF FIELDS TO TRANSFORM.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">C&gt; @param MI       - INTEGER NUMBER OF POINTS IN THE FASTER ZONAL DIRECTION</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">C&gt; @param MJ       - INTEGER NUMBER OF POINTS IN THE SLOWER MERID DIRECTION</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">C&gt; @param IPRIME   - INTEGER INPUT LONGITUDE INDEX FOR THE PRIME MERIDIAN.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO 1 IF IPRIME=0)</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">C&gt;                (OUTPUT LONGITUDE INDEX FOR PRIME MERIDIAN ASSUMED 1.)</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">C&gt; @param ISKIPI   - INTEGER SKIP NUMBER BETWEEN INPUT LONGITUDES</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO 1 IF ISKIPI=0)</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">C&gt; @param JSKIPI   - INTEGER SKIP NUMBER BETWEEN INPUT LATITUDES FROM SOUTH</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO -IMAXI IF JSKIPI=0)</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">C&gt; @param KSKIPI   - INTEGER SKIP NUMBER BETWEEN INPUT GRID FIELDS</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO IMAXI*JMAXI IF KSKIPI=0)</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">C&gt; @param KGSKIP   - INTEGER SKIP NUMBER BETWEEN GRID FIELDS</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO MI*MJ IF KGSKIP=0)</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">C&gt; @param NISKIP   - INTEGER SKIP NUMBER BETWEEN GRID I-POINTS</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO 1 IF NISKIP=0)</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">C&gt; @param NJSKIP   - INTEGER SKIP NUMBER BETWEEN GRID J-POINTS</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO MI IF NJSKIP=0)</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">C&gt; @param JCPU     - INTEGER NUMBER OF CPUS OVER WHICH TO MULTIPROCESS</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">C&gt;                (DEFAULTS TO ENVIRONMENT NCPUS IF JCPU=0)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">C&gt; @param RLAT1    - REAL LATITUDE OF THE FIRST GRID POINT IN DEGREES</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">C&gt; @param RLON1    - REAL LONGITUDE OF THE FIRST GRID POINT IN DEGREES</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">C&gt; @param DLAT     - REAL LATITUDE INCREMENT IN DEGREES SUCH THAT</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">C&gt;                D(PHI)/D(J)=DLAT*COS(PHI) WHERE J IS MERIDIONAL INDEX.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">C&gt;                DLAT IS NEGATIVE FOR GRIDS INDEXED SOUTHWARD.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">C&gt;                (IN TERMS OF GRID INCREMENT DY VALID AT LATITUDE RLATI,</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">C&gt;                 THE LATITUDE INCREMENT DLAT IS DETERMINED AS</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">C&gt;                 DLAT=DPR*DY/(RERTH*COS(RLATI/DPR))</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">C&gt;                 WHERE DPR=180/PI AND RERTH IS EARTH&#39;S RADIUS)</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">C&gt; @param DLON     - REAL LONGITUDE INCREMENT IN DEGREES SUCH THAT</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">C&gt;                D(LAMBDA)/D(I)=DLON WHERE I IS ZONAL INDEX.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">C&gt;                DLON IS NEGATIVE FOR GRIDS INDEXED WESTWARD.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">C&gt; @param GRIDUI   - REAL (*) INPUT GRID U-WINDS</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">C&gt; @param GRIDVI   - REAL (*) INPUT GRID V-WINDS</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">C&gt; @param LUV      - LOGICAL FLAG WHETHER TO RETURN WINDS</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">C&gt; @param LDZ      - LOGICAL FLAG WHETHER TO RETURN DIVERGENCE AND VORTICITY</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">C&gt; @param LPS      - LOGICAL FLAG WHETHER TO RETURN POTENTIAL AND STREAMFCN</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">C&gt; @param UM       - REAL (*) MERCATOR U-WINDS IF LUV</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">C&gt; @param VM       - REAL (*) MERCATOR V-WINDS IF LUV</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">C&gt; @param DM       - REAL (*) MERCATOR DIVERGENCES IF LDZ</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">C&gt; @param ZM       - REAL (*) MERCATOR VORTICITIES IF LDZ</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">C&gt; @param PM       - REAL (*) MERCATOR POTENTIALS IF LPS</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">C&gt; @param SM       - REAL (*) MERCATOR STREAMFCNS IF LPS</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">C&gt; SUBPROGRAMS CALLED:</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">C&gt;  - SPWGET       GET WAVE-SPACE CONSTANTS</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">C&gt;  - SPLAPLAC     COMPUTE LAPLACIAN IN SPECTRAL SPACE</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">C&gt;  - SPTRANV      PERFORM A VECTOR SPHERICAL TRANSFORM</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">C&gt;  - SPTGPM       TRANSFORM SPECTRAL SCALAR TO MERCATOR</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">C&gt;  - SPTGPMV      TRANSFORM SPECTRAL VECTOR TO MERCATOR</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">C&gt;  - NCPUS        GETS ENVIRONMENT NUMBER OF CPUS</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">C&gt; REMARKS: MINIMUM GRID DIMENSIONS FOR UNALIASED TRANSFORMS TO SPECTRAL:</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">C&gt;   DIMENSION                    |LINEAR              |QUADRATIC</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">C&gt;   -----------------------      |---------           |-------------</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">C&gt;   IMAX                         |2*MAXWV+2           |3*MAXWV/2*2+2</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">C&gt;   JMAX (IDRT=4,IROMB=0)        |1*MAXWV+1           |3*MAXWV/2+1</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">C&gt;   JMAX (IDRT=4,IROMB=1)        |2*MAXWV+1           |5*MAXWV/2+1</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">C&gt;   JMAX (IDRT=0,IROMB=0)        |2*MAXWV+3           |3*MAXWV/2*2+3</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">C&gt;   JMAX (IDRT=0,IROMB=1)        |4*MAXWV+3           |5*MAXWV/2*2+3</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">C&gt;   JMAX (IDRT=256,IROMB=0)      |2*MAXWV+1           |3*MAXWV/2*2+1</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">C&gt;   JMAX (IDRT=256,IROMB=1)      |4*MAXWV+1           |5*MAXWV/2*2+1</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="sptrunmv_8f.html#a8b405d0621112d6852a3bb99602ac2fd">   92</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="sptrunmv_8f.html#a8b405d0621112d6852a3bb99602ac2fd">sptrunmv</a>(IROMB,MAXWV,IDRTI,IMAXI,JMAXI,KMAX,MI,MJ,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     &amp;                    IPRIME,ISKIPI,JSKIPI,KSKIPI,KGSKIP,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;     &amp;                    NISKIP,NJSKIP,JCPU,RLAT1,RLON1,DLAT,DLON,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;     &amp;                    GRIDUI,GRIDVI,LUV,UM,VM,LDZ,DM,ZM,LPS,PM,SM)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordtype">LOGICAL</span> LUV,LDZ,LPS</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordtype">REAL</span> GRIDUI(*),GRIDVI(*)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordtype">REAL</span> UM(*),VM(*),DM(*),ZM(*),PM(*),SM(*)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordtype">      REAL</span> W((MAXWV+1)*((IROMB+1)*MAXWV+2)/2*2+1,KMAX)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keywordtype">      REAL</span> EPS((MAXWV+1)*((IROMB+1)*MAXWV+2)/2),EPSTOP(MAXWV+1)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordtype">      REAL</span> ENN1((MAXWV+1)*((IROMB+1)*MAXWV+2)/2)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">      REAL</span> ELONN1((MAXWV+1)*((IROMB+1)*MAXWV+2)/2)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordtype">      REAL</span> EON((MAXWV+1)*((IROMB+1)*MAXWV+2)/2),EONTOP(MAXWV+1)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">      REAL</span> WD((MAXWV+1)*((IROMB+1)*MAXWV+2)/2*2+1,KMAX)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">      REAL</span> WZ((MAXWV+1)*((IROMB+1)*MAXWV+2)/2*2+1,KMAX)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">C  TRANSFORM INPUT GRID TO WAVE</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      jc=jcpu</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">IF</span>(jc.EQ.0) jc=<a class="code" href="ncpus_8F.html#a821a75ee067ea31758a038c0327bd3bd">ncpus</a>()</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      mx=(maxwv+1)*((iromb+1)*maxwv+2)/2</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      mdim=2*mx+1</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      jn=-jskipi</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">IF</span>(jn.EQ.0) jn=imaxi</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      js=-jn</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      inp=(jmaxi-1)*max(0,-jn)+1</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      isp=(jmaxi-1)*max(0,-js)+1</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keyword">CALL </span><a class="code" href="sptranv_8f.html#a7d6aaa3ed70df1dfaf8dd4443b7190c1">sptranv</a>(iromb,maxwv,idrti,imaxi,jmaxi,kmax,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;     &amp;             iprime,iskipi,jn,js,mdim,kskipi,0,0,jc,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;     &amp;             wd,wz,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;     &amp;             gridui(inp),gridui(isp),gridvi(inp),gridvi(isp),-1)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">C  TRANSFORM WAVE TO OUTPUT WINDS</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">IF</span>(luv) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keyword">CALL </span><a class="code" href="sptgpmv_8f.html#a15de3accfd448d116324872c8fb1bb17">sptgpmv</a>(iromb,maxwv,kmax,mi,mj,mdim,kgskip,niskip,njskip,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     &amp;               rlat1,rlon1,dlat,dlon,wd,wz,um,vm)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">C  TRANSFORM WAVE TO OUTPUT DIVERGENCE AND VORTICITY</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">IF</span>(ldz) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keyword">CALL </span><a class="code" href="sptgpm_8f.html#a6cffaeaa602eaae5c03166f48065158d">sptgpm</a>(iromb,maxwv,kmax,mi,mj,mdim,kgskip,niskip,njskip,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     &amp;              rlat1,rlon1,dlat,dlon,wd,dm)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keyword">CALL </span><a class="code" href="sptgpm_8f.html#a6cffaeaa602eaae5c03166f48065158d">sptgpm</a>(iromb,maxwv,kmax,mi,mj,mdim,kgskip,niskip,njskip,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     &amp;              rlat1,rlon1,dlat,dlon,wz,zm)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">C  TRANSFORM WAVE TO OUTPUT POTENTIAL AND STREAMFUNCTION</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">IF</span>(lps) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keyword">CALL </span><a class="code" href="spwget_8f.html#a9b6ce78350f7adf2fed874a18312c7a6">spwget</a>(iromb,maxwv,eps,epstop,enn1,elonn1,eon,eontop)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">C$OMP PARALLEL DO</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">DO</span> k=1,kmax</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="keyword">CALL </span><a class="code" href="splaplac_8f.html#a64338955857a3cf58283146940e7ae42">splaplac</a>(iromb,maxwv,enn1,wd(1,k),wd(1,k),-1)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keyword">CALL </span><a class="code" href="splaplac_8f.html#a64338955857a3cf58283146940e7ae42">splaplac</a>(iromb,maxwv,enn1,wz(1,k),wz(1,k),-1)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          wd(1:2,k)=0.</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          wz(1:2,k)=0.</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">CALL </span><a class="code" href="sptgpm_8f.html#a6cffaeaa602eaae5c03166f48065158d">sptgpm</a>(iromb,maxwv,kmax,mi,mj,mdim,kgskip,niskip,njskip,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;     &amp;              rlat1,rlon1,dlat,dlon,wd,pm)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keyword">CALL </span><a class="code" href="sptgpm_8f.html#a6cffaeaa602eaae5c03166f48065158d">sptgpm</a>(iromb,maxwv,kmax,mi,mj,mdim,kgskip,niskip,njskip,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;     &amp;              rlat1,rlon1,dlat,dlon,wz,sm)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keyword">END</span></div>
<div class="ttc" id="ancpus_8F_html_a821a75ee067ea31758a038c0327bd3bd"><div class="ttname"><a href="ncpus_8F.html#a821a75ee067ea31758a038c0327bd3bd">ncpus</a></div><div class="ttdeci">function ncpus()</div><div class="ttdoc">Set number of CPUs - the number of processors over which to parallelize.</div><div class="ttdef"><b>Definition:</b> <a href="ncpus_8F_source.html#l00023">ncpus.F:24</a></div></div>
<div class="ttc" id="asplaplac_8f_html_a64338955857a3cf58283146940e7ae42"><div class="ttname"><a href="splaplac_8f.html#a64338955857a3cf58283146940e7ae42">splaplac</a></div><div class="ttdeci">subroutine splaplac(I, M, ENN1, Q, QD2, IDIR)</div><div class="ttdoc">Computes the laplacian or the inverse laplacian of a scalar field in spectral space.</div><div class="ttdef"><b>Definition:</b> <a href="splaplac_8f_source.html#l00024">splaplac.f:25</a></div></div>
<div class="ttc" id="asptgpm_8f_html_a6cffaeaa602eaae5c03166f48065158d"><div class="ttname"><a href="sptgpm_8f.html#a6cffaeaa602eaae5c03166f48065158d">sptgpm</a></div><div class="ttdeci">subroutine sptgpm(IROMB, MAXWV, KMAX, MI, MJ, KWSKIP, KGSKIP, NISKIP, NJSKIP, RLAT1, RLON1, DLAT, DLON, WAVE, GM)</div><div class="ttdoc">This subprogram performs a spherical transform from spectral coefficients of scalar quantities to sca...</div><div class="ttdef"><b>Definition:</b> <a href="sptgpm_8f_source.html#l00053">sptgpm.f:56</a></div></div>
<div class="ttc" id="asptgpmv_8f_html_a15de3accfd448d116324872c8fb1bb17"><div class="ttname"><a href="sptgpmv_8f.html#a15de3accfd448d116324872c8fb1bb17">sptgpmv</a></div><div class="ttdeci">subroutine sptgpmv(IROMB, MAXWV, KMAX, MI, MJ, KWSKIP, KGSKIP, NISKIP, NJSKIP, RLAT1, RLON1, DLAT, DLON, WAVED, WAVEZ, UM, VM)</div><div class="ttdoc">This subprogram performs a spherical transform from spectral coefficients of divergences and curls to...</div><div class="ttdef"><b>Definition:</b> <a href="sptgpmv_8f_source.html#l00060">sptgpmv.f:63</a></div></div>
<div class="ttc" id="asptranv_8f_html_a7d6aaa3ed70df1dfaf8dd4443b7190c1"><div class="ttname"><a href="sptranv_8f.html#a7d6aaa3ed70df1dfaf8dd4443b7190c1">sptranv</a></div><div class="ttdeci">subroutine sptranv(IROMB, MAXWV, IDRT, IMAX, JMAX, KMAX, IPRIME, ISKIP, JNSKIP, JSSKIP, KWSKIP, KGSKIP, JBEG, JEND, JCPU, WAVED, WAVEZ, GRIDUN, GRIDUS, GRIDVN, GRIDVS, IDIR)</div><div class="ttdoc">This subprogram performs a spherical transform between spectral coefficients of divergences and curls...</div><div class="ttdef"><b>Definition:</b> <a href="sptranv_8f_source.html#l00087">sptranv.f:91</a></div></div>
<div class="ttc" id="asptrunmv_8f_html_a8b405d0621112d6852a3bb99602ac2fd"><div class="ttname"><a href="sptrunmv_8f.html#a8b405d0621112d6852a3bb99602ac2fd">sptrunmv</a></div><div class="ttdeci">subroutine sptrunmv(IROMB, MAXWV, IDRTI, IMAXI, JMAXI, KMAX, MI, MJ, IPRIME, ISKIPI, JSKIPI, KSKIPI, KGSKIP, NISKIP, NJSKIP, JCPU, RLAT1, RLON1, DLAT, DLON, GRIDUI, GRIDVI, LUV, UM, VM, LDZ, DM, ZM, LPS, PM, SM)</div><div class="ttdoc">THIS SUBPROGRAM SPECTRALLY TRUNCATES VECTOR FIELDS ON A GLOBAL CYLINDRICAL GRID, RETURNING THE FIELDS...</div><div class="ttdef"><b>Definition:</b> <a href="sptrunmv_8f_source.html#l00092">sptrunmv.f:96</a></div></div>
<div class="ttc" id="aspwget_8f_html_a9b6ce78350f7adf2fed874a18312c7a6"><div class="ttname"><a href="spwget_8f.html#a9b6ce78350f7adf2fed874a18312c7a6">spwget</a></div><div class="ttdeci">subroutine spwget(IROMB, MAXWV, EPS, EPSTOP, ENN1, ELONN1, EON, EONTOP)</div><div class="ttdoc">This subprogram gets wave-space constants.</div><div class="ttdef"><b>Definition:</b> <a href="spwget_8f_source.html#l00017">spwget.f:18</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="sptrunmv_8f.html">sptrunmv.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
