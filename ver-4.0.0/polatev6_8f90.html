<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-ip: polatev6.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-ip
   &#160;<span id="projectnumber">3.3.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('polatev6_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">polatev6.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="polatev6_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a841645f4ca5c009269de8924fe5d1f8e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="polatev6_8f90.html#a841645f4ca5c009269de8924fe5d1f8e">polatev6</a> (IPOPT, KGDSI, KGDSO, MI, MO, KM, IBI, LI, UI, VI, NO, RLAT, RLON, CROT, SROT, IBO, LO, UO, VO, IRET)</td></tr>
<tr class="memdesc:a841645f4ca5c009269de8924fe5d1f8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS SUBPROGRAM PERFORMS BUDGET INTERPOLATION FROM ANY GRID TO ANY GRID FOR VECTOR FIELDS.  <a href="polatev6_8f90.html#a841645f4ca5c009269de8924fe5d1f8e">More...</a><br /></td></tr>
<tr class="separator:a841645f4ca5c009269de8924fe5d1f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>INTERPOLATE VECTOR FIELDS (BUDGET) </p><dl class="section author"><dt>Author</dt><dd>IREDELL </dd></dl>
<dl class="section date"><dt>Date</dt><dd>96-04-10 </dd></dl>

<p class="definition">Definition in file <a class="el" href="polatev6_8f90_source.html">polatev6.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a841645f4ca5c009269de8924fe5d1f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a841645f4ca5c009269de8924fe5d1f8e">&#9670;&nbsp;</a></span>polatev6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine polatev6 </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(20), intent(in)&#160;</td>
          <td class="paramname"><em>IPOPT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(200), intent(in)&#160;</td>
          <td class="paramname"><em>KGDSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(200), intent(in)&#160;</td>
          <td class="paramname"><em>KGDSO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>KM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>IBI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical*1, dimension(mi,km), intent(in)&#160;</td>
          <td class="paramname"><em>LI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mi,km), intent(in)&#160;</td>
          <td class="paramname"><em>UI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mi,km), intent(in)&#160;</td>
          <td class="paramname"><em>VI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>NO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo), intent(inout)&#160;</td>
          <td class="paramname"><em>RLAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo), intent(inout)&#160;</td>
          <td class="paramname"><em>RLON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo), intent(out)&#160;</td>
          <td class="paramname"><em>CROT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo), intent(out)&#160;</td>
          <td class="paramname"><em>SROT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>IBO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical*1, dimension(mo,km), intent(out)&#160;</td>
          <td class="paramname"><em>LO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo,km), intent(out)&#160;</td>
          <td class="paramname"><em>UO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mo,km), intent(out)&#160;</td>
          <td class="paramname"><em>VO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>IRET</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>THIS SUBPROGRAM PERFORMS BUDGET INTERPOLATION FROM ANY GRID TO ANY GRID FOR VECTOR FIELDS. </p>
<p>IT REQUIRES A GRID FOR THE OUTPUT FIELDS (KGDSO(1)&gt;=0). THE ALGORITHM SIMPLY COMPUTES (WEIGHTED) AVERAGES OF NEIGHBOR POINTS ARRANGED IN A SQUARE BOX CENTERED AROUND EACH OUTPUT GRID POINT AND STRETCHING NEARLY HALFWAY TO EACH OF THE NEIGHBORING GRID POINTS. OPTIONS ALLOW CHOICES OF NUMBER OF POINTS IN EACH RADIUS FROM THE CENTER POINT (IPOPT(1)) WHICH DEFAULTS TO 2 (IF IPOPT(1)=-1) MEANING THAT 25 POINTS WILL BE AVERAGED; FURTHER OPTIONS ARE THE RESPECTIVE WEIGHTS FOR THE RADIUS POINTS STARTING AT THE CENTER POINT (IPOPT(2:2+IPOPT(1)) WHICH DEFAULTS TO ALL 1 (IF IPOPT(1)=-1 OR IPOPT(2)=-1). ANOTHER OPTION IS THE MINIMUM PERCENTAGE FOR MASK, I.E. PERCENT VALID INPUT DATA REQUIRED TO MAKE OUTPUT DATA, (IPOPT(3+IPOPT(1)) WHICH DEFAULTS TO 50 (IF -1). ONLY HORIZONTAL INTERPOLATION IS PERFORMED. THE GRIDS ARE DEFINED BY THEIR GRID DESCRIPTION SECTIONS (PASSED IN INTEGER FORM AS DECODED BY SUBPROGRAM W3FI63). THE CURRENT CODE RECOGNIZES THE FOLLOWING PROJECTIONS: (KGDS(1)=000) EQUIDISTANT CYLINDRICAL (KGDS(1)=001) MERCATOR CYLINDRICAL (KGDS(1)=003) LAMBERT CONFORMAL CONICAL (KGDS(1)=004) GAUSSIAN CYLINDRICAL (SPECTRAL NATIVE) (KGDS(1)=005) POLAR STEREOGRAPHIC AZIMUTHAL (KGDS(1)=203) ROTATED EQUIDISTANT CYLINDRICAL (E-STAGGER) (KGDS(1)=205) ROTATED EQUIDISTANT CYLINDRICAL (B-STAGGER) WHERE KGDS COULD BE EITHER INPUT KGDSI OR OUTPUT KGDSO. THE INPUT AND OUTPUT VECTORS ARE ROTATED SO THAT THEY ARE EITHER RESOLVED RELATIVE TO THE DEFINED GRID IN THE DIRECTION OF INCREASING X AND Y COORDINATES OR RESOLVED RELATIVE TO EASTERLY AND NORTHERLY DIRECTIONS, AS DESIGNATED BY THEIR RESPECTIVE GRID DESCRIPTION SECTIONS. AS AN ADDED BONUS THE NUMBER OF OUTPUT GRID POINTS AND THEIR LATITUDES AND LONGITUDES ARE ALSO RETURNED ALONG WITH THEIR VECTOR ROTATION PARAMETERS. INPUT BITMAPS WILL BE INTERPOLATED TO OUTPUT BITMAPS. OUTPUT BITMAPS WILL ALSO BE CREATED WHEN THE OUTPUT GRID EXTENDS OUTSIDE OF THE DOMAIN OF THE INPUT GRID. THE OUTPUT FIELD IS SET TO 0 WHERE THE OUTPUT BITMAP IS OFF.</p>
<p>PROGRAM HISTORY LOG:</p><ul>
<li>96-04-10 IREDELL</li>
<li>1999-04-08 IREDELL SPLIT IJKGDS INTO TWO PIECES</li>
<li>2001-06-18 IREDELL INCLUDE MINIMUM MASK PERCENTAGE OPTION</li>
<li>2002-01-17 IREDELL SAVE DATA FROM LAST CALL FOR OPTIMIZATION</li>
<li>2015-01-27 GAYNO REPLACE CALLS TO GDSWIZ WITH NEW MERGED ROUTINE GDSWZD.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">IPOPT</td><td>- INTEGER (20) INTERPOLATION OPTIONS IPOPT(1) IS NUMBER OF RADIUS POINTS (DEFAULTS TO 2 IF IPOPT(1)=-1); IPOPT(2:2+IPOPT(1)) ARE RESPECTIVE WEIGHTS (DEFAULTS TO ALL 1 IF IPOPT(1)=-1 OR IPOPT(2)=-1). IPOPT(3+IPOPT(1)) IS MINIMUM PERCENTAGE FOR MASK (DEFAULTS TO 50 IF IPOPT(3+IPOPT(1)=-1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KGDSI</td><td>- INTEGER (200) INPUT GDS PARAMETERS AS DECODED BY W3FI63 </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KGDSO</td><td>- INTEGER (200) OUTPUT GDS PARAMETERS </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MI</td><td>- INTEGER SKIP NUMBER BETWEEN INPUT GRID FIELDS IF KM&gt;1 OR DIMENSION OF INPUT GRID FIELDS IF KM=1 </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MO</td><td>- INTEGER SKIP NUMBER BETWEEN OUTPUT GRID FIELDS IF KM&gt;1 OR DIMENSION OF OUTPUT GRID FIELDS IF KM=1 </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KM</td><td>- INTEGER NUMBER OF FIELDS TO INTERPOLATE </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">IBI</td><td>- INTEGER (KM) INPUT BITMAP FLAGS </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">LI</td><td>- LOGICAL*1 (MI,KM) INPUT BITMAPS (IF SOME IBI(K)=1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">UI</td><td>- REAL (MI,KM) INPUT U-COMPONENT FIELDS TO INTERPOLATE </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">VI</td><td>- REAL (MI,KM) INPUT V-COMPONENT FIELDS TO INTERPOLATE </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NO</td><td>- INTEGER NUMBER OF OUTPUT POINTS </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RLAT</td><td>- REAL (MO) OUTPUT LATITUDES IN DEGREES </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RLON</td><td>- REAL (MO) OUTPUT LONGITUDES IN DEGREES </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CROT</td><td>- REAL (NO) VECTOR ROTATION COSINES </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SROT</td><td>- REAL (NO) VECTOR ROTATION SINES (UGRID=CROT*UEARTH-SROT*VEARTH; VGRID=SROT*UEARTH+CROT*VEARTH) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">IBO</td><td>- INTEGER (KM) OUTPUT BITMAP FLAGS </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">LO</td><td>- LOGICAL*1 (MO,KM) OUTPUT BITMAPS (ALWAYS OUTPUT) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">UO</td><td>- REAL (MO,KM) OUTPUT U-COMPONENT FIELDS INTERPOLATED </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VO</td><td>- REAL (MO,KM) OUTPUT V-COMPONENT FIELDS INTERPOLATED </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">IRET</td><td>- INTEGER RETURN CODE 0 SUCCESSFUL INTERPOLATION 2 UNRECOGNIZED INPUT GRID OR NO GRID OVERLAP 3 UNRECOGNIZED OUTPUT GRID 31 INVALID UNDEFINED OUTPUT GRID 32 INVALID BUDGET METHOD PARAMETERS</td></tr>
  </table>
  </dd>
</dl>
<p>SUBPROGRAMS CALLED:</p><ul>
<li>GDSWZD GRID DESCRIPTION SECTION WIZARD</li>
<li>IJKGDS0 SET UP PARAMETERS FOR IJKGDS1</li>
<li>(IJKGDS1) RETURN FIELD POSITION FOR A GIVEN GRID POINT</li>
<li>(MOVECT) MOVE A VECTOR ALONG A GREAT CIRCLE</li>
<li>POLFIXV MAKE MULTIPLE POLE VECTOR VALUES CONSISTENT </li>
</ul>

<p class="definition">Definition at line <a class="el" href="polatev6_8f90_source.html#l00099">99</a> of file <a class="el" href="polatev6_8f90_source.html">polatev6.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="polatev6_8f90.html">polatev6.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
